<!DOCTYPE html>
<html lang="ur" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>🕋 Namaz Timings</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/earlyaccess/notonastaliqurdu.css" rel="stylesheet" />
  <style>
    body {
      font-family: 'Noto Nastaliq Urdu', sans-serif;
      background-color: #f9f9f9;
      margin: 0;
      color: #222;
    }
    header {
      background: #00796b;
      color: white;
      text-align: center;
      padding: 15px;
    }
    .back-link {
      margin: 15px;
      text-align: left;
    }
    .back-link a {
      background: #4a148c;
      color: white;
      padding: 8px 16px;
      border-radius: 6px;
      text-decoration: none;
    }
    .box {
      max-width: 700px;
      margin: 20px auto;
      background: white;
      border: 2px solid #4a148c;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 0 12px rgba(0,0,0,0.05);
    }
    h2 {
      color: #4a148c;
    }
    label {
      display: block;
      margin-top: 12px;
      font-weight: bold;
      color: #00695c;
    }
    .time-label {
      color: #4a148c;
    }
    .time-value {
      color: #388e3c;
      font-weight: bold;
    }
    .input-row {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }
    input[type="time"] {
      padding: 6px;
      font-size: 16px;
      flex: 1;
    }
    button {
      margin-top: 15px;
      padding: 10px 20px;
      background-color: #388e3c;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    button:hover {
      background-color: #2e7d32;
    }
    footer {
      background: #00796b;
      color: white;
      text-align: center;
      padding: 10px;
      margin-top: 30px;
    }
  </style>
</head>
<body>

<header>
  <h1>🕋 Namaz Kay Awqat (نماز کے اوقات)</h1>
</header>

<div class="back-link">
  <a href="index.html">🔙 Wapas (واپس)</a>
</div>

<div class="box">
  <h2>📍 Auto Timings (خودکار اوقات)</h2>
  <div id="autoTimings">⏳ Loading...</div>

  <hr>

  <h2>📝 Manual Timings (دستی وقت درج کریں)</h2>

  <div class="input-row">
    <label class="time-label">🕌 Fajr (فجر):</label>
    <input type="time" id="manualFajr">
  </div>
  <div class="input-row">
    <label class="time-label">🕛 Dhuhr (ظہر):</label>
    <input type="time" id="manualDhuhr">
  </div>
  <div class="input-row">
    <label class="time-label">🏜 Asr (عصر):</label>
    <input type="time" id="manualAsr">
  </div>
  <div class="input-row">
    <label class="time-label">🕌 Maghrib (مغرب):</label>
    <input type="time" id="manualMaghrib">
  </div>
  <div class="input-row">
    <label class="time-label">🌃 Isha (عشاء):</label>
    <input type="time" id="manualIsha">
  </div>

  <button onclick="showManual()">📥 Save Timings (محفوظ کریں)</button>

  <div id="manualResult" style="margin-top: 20px;"></div>
</div>

<footer>
  © 2025 Islamic App | Tamam Rights Mehfooz (تمام حقوق محفوظ ہیں)
</footer>

<script>
  async function getAutoTimings() {
    try {
      const loc = await new Promise((res, rej) => navigator.geolocation.getCurrentPosition(res, rej));
      const lat = loc.coords.latitude;
      const lon = loc.coords.longitude;
      const response = await fetch(`https://api.aladhan.com/v1/timings?latitude=${lat}&longitude=${lon}&method=2`);
      const data = await response.json();
      const t = data.data.timings;

      const html = `
        <div><span class="time-label">🌅 Imsak (امساک):</span> <span class="time-value">${t.Imsak}</span></div>
        <div><span class="time-label">🕌 Fajr (فجر):</span> <span class="time-value">${t.Fajr}</span></div>
        <div><span class="time-label">🌤 Sunrise (طلوع):</span> <span class="time-value">${t.Sunrise}</span></div>
        <div><span class="time-label">☀️ Chasht (چاشت):</span> <span class="time-value">${formatTime(addMinutes(t.Sunrise, 90))}</span></div>
        <div><span class="time-label">🌞 Zawal (زوال):</span> <span class="time-value">${formatTime(addMinutes(t.Dhuhr, -5))}</span></div>
        <div><span class="time-label">🕛 Dhuhr (ظہر):</span> <span class="time-value">${t.Dhuhr}</span></div>
        <div><span class="time-label">🏜 Asr (عصر):</span> <span class="time-value">${t.Asr}</span></div>
        <div><span class="time-label">🌇 Sunset (غروب):</span> <span class="time-value">${t.Sunset}</span></div>
        <div><span class="time-label">🕌 Maghrib (مغرب):</span> <span class="time-value">${t.Maghrib}</span></div>
        <div><span class="time-label">🌃 Isha (عشاء):</span> <span class="time-value">${t.Isha}</span></div>
        <div><span class="time-label">🕋 Tahajjud (تہجد):</span> <span class="time-value">${formatTime(addMinutes(t.Fajr, -90))}</span></div>
      `;
      document.getElementById("autoTimings").innerHTML = html;
    } catch (err) {
      document.getElementById("autoTimings").innerText = "❌ Location ya Internet ka issue hai. Manual timing use karen.";
    }
  }

  function addMinutes(timeStr, mins) {
    const [h, m] = timeStr.split(":").map(Number);
    const date = new Date();
    date.setHours(h, m + mins);
    return date;
  }

  function formatTime(date) {
    const h = date.getHours().toString().padStart(2, "0");
    const m = date.getMinutes().toString().padStart(2, "0");
    return `${h}:${m}`;
  }

  function showManual() {
    const f = document.getElementById("manualFajr").value;
    const d = document.getElementById("manualDhuhr").value;
    const a = document.getElementById("manualAsr").value;
    const m = document.getElementById("manualMaghrib").value;
    const i = document.getElementById("manualIsha").value;

    if (!f || !d || !a || !m || !i) {
      alert("⛔ Har waqt bharna (ہر وقت بھرنا) zaroori hai");
      return;
    }

    const timings = { fajr: f, dhuhr: d, asr: a, maghrib: m, isha: i };
    localStorage.setItem("manualTimings", JSON.stringify(timings));

    renderManualTimings(timings);
  }

  function renderManualTimings(timings) {
    const html = `
      <div><span class="time-label">🕌 Fajr (فجر):</span> <span class="time-value">${timings.fajr}</span></div>
      <div><span class="time-label">🕛 Dhuhr (ظہر):</span> <span class="time-value">${timings.dhuhr}</span></div>
      <div><span class="time-label">🏜 Asr (عصر):</span> <span class="time-value">${timings.asr}</span></div>
      <div><span class="time-label">🕌 Maghrib (مغرب):</span> <span class="time-value">${timings.maghrib}</span></div>
      <div><span class="time-label">🌃 Isha (عشاء):</span> <span class="time-value">${timings.isha}</span></div>
    `;
    document.getElementById("manualResult").innerHTML = html;
  }

  function loadManualTimings() {
    const saved = localStorage.getItem("manualTimings");
    if (saved) {
      const timings = JSON.parse(saved);
      document.getElementById("manualFajr").value = timings.fajr;
      document.getElementById("manualDhuhr").value = timings.dhuhr;
      document.getElementById("manualAsr").value = timings.asr;
      document.getElementById("manualMaghrib").value = timings.maghrib;
      document.getElementById("manualIsha").value = timings.isha;
      renderManualTimings(timings);
    }
  }

  window.onload = () => {
    getAutoTimings();
    loadManualTimings();
  };
</script>

</body>
</html>
